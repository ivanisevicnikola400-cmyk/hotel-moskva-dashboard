<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hotel Moskva â€” Dashboard</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  
  :root {
    --bg: #0A0A0F;
    --card: #111118;
    --card-border: #1E1E2A;
    --card-inner: #0D0D14;
    --gold: #C9A84C;
    --gold-dark: #8B6914;
    --text: #DDD;
    --text-dim: #8B8B8B;
    --text-dark: #555;
    --green: #2ECC71;
    --red: #E74C3C;
    --blue: #4A8CCA;
    --line: #1A1A24;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
    min-height: 100vh;
  }

  /* Header */
  .header {
    background: var(--card-inner);
    border-bottom: 1px solid var(--line);
    padding: 16px 28px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 12px;
  }
  .header-left {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .header-stars { color: var(--gold); font-size: 11px; letter-spacing: 4px; }
  .header-title {
    font-family: Georgia, serif;
    font-size: 20px;
    color: #FFF;
    letter-spacing: 3px;
  }
  .header-title span { color: var(--gold); }
  .header-sep { height: 32px; width: 1px; background: var(--card-border); }
  .header-dash { font-size: 13px; color: var(--text-dark); letter-spacing: 1px; }
  .header-right { display: flex; align-items: center; gap: 16px; }
  .live-badge {
    display: flex; align-items: center; gap: 6px;
    padding: 6px 12px; border-radius: 20px;
  }
  .live-badge.active { background: rgba(46,204,113,0.1); }
  .live-badge.loading { background: rgba(201,168,76,0.1); }
  .live-dot {
    width: 7px; height: 7px; border-radius: 50%;
  }
  .live-dot.active { background: var(--green); }
  .live-dot.loading { background: var(--gold); animation: pulse 1s infinite; }
  .live-text { font-size: 11px; }
  .live-text.active { color: var(--green); }
  .live-text.loading { color: var(--gold); }
  .update-time { font-size: 10px; color: #444; }

  @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }

  /* Tabs */
  .tabs {
    background: var(--card-inner);
    border-bottom: 1px solid var(--line);
    padding: 0 28px;
    display: flex;
    gap: 0;
    overflow-x: auto;
  }
  .tab-btn {
    background: none; border: none; cursor: pointer;
    padding: 12px 20px; font-size: 12px; letter-spacing: 1px;
    color: var(--text-dark); border-bottom: 2px solid transparent;
    transition: all 0.2s; white-space: nowrap;
  }
  .tab-btn.active {
    color: var(--gold); border-bottom-color: var(--gold); font-weight: bold;
  }
  .tab-btn:hover { color: var(--gold); }

  /* Content */
  .content { padding: 24px 28px; max-width: 1200px; margin: 0 auto; }

  /* Stat Cards */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 12px;
    margin-bottom: 24px;
  }
  .stat-card {
    background: var(--card);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    padding: 20px 18px;
  }
  .stat-card.accent { border-top: 2px solid var(--gold); }
  .stat-icon { font-size: 24px; margin-bottom: 6px; }
  .stat-value {
    font-size: 28px; font-weight: bold; color: #FFF;
    font-family: Georgia, serif;
  }
  .stat-card.accent .stat-value { color: var(--gold); }
  .stat-label {
    font-size: 11px; color: var(--text-dark);
    letter-spacing: 1px; text-transform: uppercase; margin-top: 4px;
  }
  .stat-sub { font-size: 10px; color: #444; margin-top: 2px; }

  /* Tables */
  .table-card {
    background: var(--card);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 24px;
  }
  .table-header {
    padding: 14px 20px;
    border-bottom: 1px solid var(--line);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .table-title {
    font-size: 11px; color: var(--gold);
    letter-spacing: 2px; text-transform: uppercase;
  }
  .table-action {
    background: none; border: 1px solid #2A2A34; border-radius: 4px;
    color: var(--text-dark); font-size: 10px; padding: 4px 12px; cursor: pointer;
  }
  .table-action:hover { border-color: var(--gold); color: var(--gold); }
  .table-wrap { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; font-size: 12px; }
  th {
    padding: 10px 14px; text-align: left;
    color: #444; font-size: 10px; letter-spacing: 1px;
    text-transform: uppercase; border-bottom: 1px solid var(--line);
  }
  td { padding: 12px 14px; border-bottom: 1px solid var(--line); color: #999; }
  .td-id { color: var(--gold); font-family: monospace; font-size: 11px; }
  .td-guest { color: #FFF; font-weight: bold; }
  .td-price { color: var(--gold); font-weight: bold; }

  /* Badges */
  .badge {
    display: inline-block;
    padding: 3px 10px; border-radius: 20px;
    font-size: 10px; font-weight: bold;
  }
  .badge-confirmed { background: rgba(201,168,76,0.15); color: var(--gold); }
  .badge-active { background: rgba(46,204,113,0.15); color: var(--green); }
  .badge-checked-out { background: rgba(100,100,120,0.15); color: #888; }
  .badge-booking { background: rgba(0,53,128,0.2); color: var(--blue); }
  .badge-ana { background: rgba(201,168,76,0.15); color: var(--gold); }
  .badge-positive { background: rgba(46,204,113,0.15); color: var(--green); }
  .badge-negative { background: rgba(231,76,60,0.15); color: var(--red); }
  .badge-reservation { background: rgba(201,168,76,0.15); color: var(--gold); }
  .badge-info { background: rgba(100,100,120,0.1); color: #888; }

  /* Two Column */
  .two-col { display: flex; gap: 16px; flex-wrap: wrap; }
  .two-col > * { flex: 1 1 300px; }

  /* List Items */
  .list-item {
    padding: 12px 20px;
    border-bottom: 1px solid var(--line);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .list-item:last-child { border-bottom: none; }
  .list-name { color: #FFF; font-size: 13px; font-weight: bold; }
  .list-sub { color: var(--text-dark); font-size: 10px; margin-top: 2px; }
  .list-right { text-align: right; }

  /* Stars */
  .stars { letter-spacing: 2px; font-size: 14px; }
  .star-on { color: var(--gold); }
  .star-off { color: #2A2A34; }

  /* Call Items */
  .call-icon {
    width: 36px; height: 36px; border-radius: 50%;
    background: var(--card-inner); border: 1px solid var(--card-border);
    display: flex; align-items: center; justify-content: center; font-size: 16px;
  }
  .call-info { display: flex; align-items: center; gap: 14px; }

  /* Feedback Item */
  .feedback-item {
    padding: 16px 20px; border-bottom: 1px solid var(--line);
    background: rgba(231,76,60,0.03);
  }
  .feedback-comment {
    color: #DDD; font-size: 13px; font-style: italic;
    margin: 8px 0; line-height: 1.6;
    padding: 10px 14px; background: var(--card-inner);
    border: 1px solid var(--card-border); border-radius: 4px;
  }
  .feedback-status {
    font-size: 10px; padding: 3px 8px; border-radius: 4px;
    background: rgba(231,76,60,0.1); color: var(--red);
    font-weight: bold;
  }

  /* Chat bubble */
  .chat-item { padding: 14px 20px; border-bottom: 1px solid var(--line); }
  .chat-guest {
    background: #1A1A2E; color: #CCC; padding: 8px 14px;
    border-radius: 12px 12px 12px 2px; font-size: 12px;
    display: inline-block; max-width: 80%; margin-bottom: 6px;
  }
  .chat-ana {
    background: rgba(201,168,76,0.1); color: var(--gold); padding: 8px 14px;
    border-radius: 12px 12px 2px 12px; font-size: 12px;
    display: inline-block; max-width: 80%; margin-left: 20%;
  }
  .chat-meta { font-size: 9px; color: #444; margin-top: 4px; }

  /* Footer */
  .footer {
    padding: 20px 28px; text-align: center;
    border-top: 1px solid var(--line); margin-top: 40px;
  }
  .footer-title { font-size: 10px; color: #333; letter-spacing: 3px; }
  .footer-sub { font-size: 9px; color: #222; }

  /* Refresh button */
  .refresh-btn {
    background: none; border: 1px solid #2A2A34; border-radius: 4px;
    color: var(--text-dark); font-size: 10px; padding: 4px 10px; cursor: pointer;
  }
  .refresh-btn:hover { border-color: var(--gold); color: var(--gold); }

  /* Loading overlay */
  .loading-overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(10,10,15,0.9); display: flex;
    align-items: center; justify-content: center;
    flex-direction: column; z-index: 1000;
  }
  .loading-spinner {
    width: 40px; height: 40px; border: 3px solid #1E1E2A;
    border-top-color: var(--gold); border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
  .loading-text { color: var(--text-dark); font-size: 13px; margin-top: 16px; letter-spacing: 2px; }

  /* Responsive */
  @media (max-width: 768px) {
    .content { padding: 16px 12px; }
    .header { padding: 12px 16px; }
    .tabs { padding: 0 12px; }
    .stat-value { font-size: 22px; }
    .two-col > * { flex: 1 1 100%; }
  }
</style>
</head>
<body>

<!-- Loading -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-spinner"></div>
  <div class="loading-text">UÄŒITAVANJE PODATAKA...</div>
</div>

<!-- Header -->
<div class="header">
  <div class="header-left">
    <div>
      <div class="header-stars">â˜… â˜… â˜… â˜…</div>
      <h1 class="header-title">HOTEL <span>MOSKVA</span></h1>
    </div>
    <div class="header-sep"></div>
    <span class="header-dash">DASHBOARD</span>
  </div>
  <div class="header-right">
    <button class="refresh-btn" onclick="fetchData()">â†» OsveÅ¾i</button>
    <div class="live-badge active" id="liveBadge">
      <div class="live-dot active" id="liveDot"></div>
      <span class="live-text active" id="liveText">Live</span>
    </div>
    <span class="update-time" id="updateTime">--:--:--</span>
  </div>
</div>

<!-- Tabs -->
<div class="tabs">
  <button class="tab-btn active" data-tab="overview" onclick="switchTab('overview', this)">Pregled</button>
  <button class="tab-btn" data-tab="reservations" onclick="switchTab('reservations', this)">Rezervacije</button>
  <button class="tab-btn" data-tab="reviews" onclick="switchTab('reviews', this)">Recenzije</button>
  <button class="tab-btn" data-tab="calls" onclick="switchTab('calls', this)">Pozivi & Chat</button>
  <button class="tab-btn" data-tab="feedback" onclick="switchTab('feedback', this)">Feedback</button>
</div>

<!-- Content -->
<div class="content" id="mainContent"></div>

<!-- Footer -->
<div class="footer">
  <div class="footer-title">â˜… HOTEL MOSKVA MANAGEMENT SYSTEM â˜…</div>
  <div class="footer-sub">Powered by AI Â· Ana Agent Â· n8n Automation</div>
</div>

<script>
const WEBHOOK_URL = 'https://nolimitnikola.app.n8n.cloud/webhook/hotel-dashboard-data';
let dashData = null;
let currentTab = 'overview';

// Stars HTML
function starsHtml(rating) {
  let html = '<span class="stars">';
  for (let i = 1; i <= 5; i++) {
    html += `<span class="${i <= rating ? 'star-on' : 'star-off'}">â˜…</span>`;
  }
  return html + '</span>';
}

// Status badge
function statusBadge(status) {
  const cls = {
    'PotvrÄ‘ena': 'badge-confirmed',
    'Aktivan': 'badge-active',
    'Checked Out': 'badge-checked-out'
  }[status] || 'badge-confirmed';
  return `<span class="badge ${cls}">${status}</span>`;
}

// Source badge
function sourceBadge(source) {
  const isBooking = (source || '').toLowerCase().includes('booking');
  return isBooking
    ? `<span class="badge badge-booking">Booking</span>`
    : `<span class="badge badge-ana">Ana AI</span>`;
}

// Fetch data
async function fetchData() {
  const badge = document.getElementById('liveBadge');
  const dot = document.getElementById('liveDot');
  const text = document.getElementById('liveText');

  badge.className = 'live-badge loading';
  dot.className = 'live-dot loading';
  text.className = 'live-text loading';
  text.textContent = 'AÅ¾uriranje...';

  try {
    const res = await fetch(WEBHOOK_URL);
    if (res.ok) {
      dashData = await res.json();
    }
  } catch (e) {
    console.log('Webhook nedostupan, koristim demo podatke');
    if (!dashData) dashData = getDemoData();
  }

  if (!dashData) dashData = getDemoData();

  badge.className = 'live-badge active';
  dot.className = 'live-dot active';
  text.className = 'live-text active';
  text.textContent = 'Live';

  document.getElementById('updateTime').textContent = new Date().toLocaleTimeString('sr-RS');
  document.getElementById('loadingOverlay').style.display = 'none';

  renderTab();
}

// Demo data fallback
function getDemoData() {
  return {
    stats: {
      totalReservations: 47, activeGuests: 12, todayCheckins: 3, todayCheckouts: 2,
      monthlyRevenue: 14580, avgRating: 4.6, totalCalls: 89, chatSessions: 34,
      reviewsSent: 38, positiveReviews: 31, negativeReviews: 7, emailsSent: 124
    },
    recentReservations: [
      { id: "BK847291", guest: "Nikola JoviÄ‡", room: "Superior Duplex", checkIn: "2026-02-25", checkOut: "2026-02-28", price: "390 EUR", source: "Booking.com", status: "PotvrÄ‘ena" },
      { id: "BK847290", guest: "Ana MarkoviÄ‡", room: "Standard King", checkIn: "2026-02-24", checkOut: "2026-02-26", price: "194 EUR", source: "AI Agent Ana", status: "Aktivan" },
      { id: "BK847289", guest: "John Smith", room: "Junior Suite", checkIn: "2026-02-24", checkOut: "2026-02-27", price: "600 EUR", source: "Booking.com", status: "Aktivan" },
      { id: "BK847288", guest: "Milica ÄorÄ‘eviÄ‡", room: "Premium Suite", checkIn: "2026-02-23", checkOut: "2026-02-25", price: "600 EUR", source: "AI Agent Ana", status: "Checked Out" },
      { id: "BK847287", guest: "Peter Mueller", room: "Royal Suite", checkIn: "2026-02-22", checkOut: "2026-02-26", price: "1350 EUR", source: "Booking.com", status: "Aktivan" }
    ],
    recentReviews: [
      { guest: "Milica ÄorÄ‘eviÄ‡", rating: 5, date: "2026-02-23", type: "Pozitivna" },
      { guest: "Marko NikoliÄ‡", rating: 4, date: "2026-02-22", type: "Pozitivna" },
      { guest: "Sarah Johnson", rating: 5, date: "2026-02-21", type: "Pozitivna" },
      { guest: "Ivan PopoviÄ‡", rating: 2, date: "2026-02-20", type: "Negativna" }
    ],
    recentFeedback: [
      { guest: "Ivan PopoviÄ‡", email: "ivan@gmail.com", rating: "2", comment: "Soba je bila hladna, grejanje nije radilo kako treba.", status: "Novo - ÄŒeka odgovor", date: "2026-02-20" }
    ],
    recentEvents: [
      { time: "2026-02-24 14:32", caller: "+381 64 123 4567", type: "Poziv", details: "Rezervacija za 2 osobe" },
      { time: "2026-02-24 13:15", caller: "+381 63 987 6543", type: "Poziv", details: "Pitanje o cenama" },
      { time: "2026-02-24 11:48", caller: "+44 20 7946 0958", type: "Poziv", details: "Rezervacija suite" },
      { time: "2026-02-24 10:05", caller: "+381 61 555 3333", type: "Poziv", details: "Transfer sa aerodroma" }
    ],
    recentChats: [
      { date: "2026-02-24 15:10", sessionId: "ch_001", message: "Zdravo, koliko koÅ¡ta noÄ‡enje?", reply: "Dobar dan! Cene poÄinju od 67 EUR za Economy sobu...", language: "sr" },
      { date: "2026-02-24 14:45", sessionId: "ch_002", message: "Do you have a spa?", reply: "Yes! Our EVA Spa & Wellness center is free for all guests...", language: "en" }
    ]
  };
}

// Switch tab
function switchTab(tab, btn) {
  currentTab = tab;
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  if (btn) btn.classList.add('active');
  renderTab();
}

// Stat card HTML
function statCard(icon, label, value, sub, accent) {
  return `
    <div class="stat-card ${accent ? 'accent' : ''}">
      <div class="stat-icon">${icon}</div>
      <div class="stat-value">${value}</div>
      <div class="stat-label">${label}</div>
      ${sub ? `<div class="stat-sub">${sub}</div>` : ''}
    </div>`;
}

// Render current tab
function renderTab() {
  const el = document.getElementById('mainContent');
  if (!dashData) return;
  const s = dashData.stats;
  const reviewRate = s.reviewsSent > 0 ? Math.round((s.positiveReviews / s.reviewsSent) * 100) : 0;

  switch (currentTab) {

    case 'overview':
      el.innerHTML = `
        <div class="stats-grid">
          ${statCard('ğŸ“‹', 'Rezervacije', s.totalReservations, 'ukupno', true)}
          ${statCard('ğŸ¨', 'Aktivni gosti', s.activeGuests, 'trenutno')}
          ${statCard('â¡ï¸', 'Check-in danas', s.todayCheckins)}
          ${statCard('â¬…ï¸', 'Check-out danas', s.todayCheckouts)}
          ${statCard('ğŸ’°', 'Prihod (mesec)', 'â‚¬' + s.monthlyRevenue.toLocaleString(), '', true)}
          ${statCard('â­', 'ProseÄna ocena', s.avgRating, '/5.0', true)}
        </div>
        <div class="stats-grid">
          ${statCard('ğŸ“', 'Pozivi (Ana AI)', s.totalCalls, 'ovog meseca')}
          ${statCard('ğŸ’¬', 'Chat sesije', s.chatSessions, 'ovog meseca')}
          ${statCard('ğŸ“§', 'Emailovi poslati', s.emailsSent, 'follow-up + potvrde')}
          ${statCard('â­', 'Pozitivne recenzije', reviewRate + '%', s.positiveReviews + '/' + s.reviewsSent, true)}
        </div>

        <!-- Recent Reservations -->
        <div class="table-card">
          <div class="table-header">
            <span class="table-title">âœ¦ Poslednje rezervacije</span>
            <button class="table-action" onclick="switchTab('reservations', document.querySelector('[data-tab=reservations]'))">Sve â†’</button>
          </div>
          <div class="table-wrap">
            <table>
              <thead><tr><th>ID</th><th>Gost</th><th>Soba</th><th>Check-in</th><th>Cena</th><th>Izvor</th><th>Status</th></tr></thead>
              <tbody>
                ${dashData.recentReservations.slice(0, 3).map(r => `
                  <tr>
                    <td class="td-id">${r.id}</td>
                    <td class="td-guest">${r.guest}</td>
                    <td>${r.room}</td>
                    <td>${r.checkIn}</td>
                    <td class="td-price">${r.price}</td>
                    <td>${sourceBadge(r.source)}</td>
                    <td>${statusBadge(r.status)}</td>
                  </tr>`).join('')}
              </tbody>
            </table>
          </div>
        </div>

        <!-- Reviews + Calls side by side -->
        <div class="two-col">
          <div class="table-card">
            <div class="table-header"><span class="table-title">âœ¦ Poslednje ocene</span></div>
            ${dashData.recentReviews.slice(0, 4).map(r => `
              <div class="list-item">
                <div>
                  <div class="list-name">${r.guest}</div>
                  <div class="list-sub">${r.date}</div>
                </div>
                <div class="list-right">
                  ${starsHtml(r.rating)}
                  <div style="margin-top:2px;">
                    <span class="badge ${r.rating >= 4 ? 'badge-positive' : 'badge-negative'}">
                      ${r.rating >= 4 ? 'â†’ Google Review' : 'â†’ Interni feedback'}
                    </span>
                  </div>
                </div>
              </div>`).join('')}
          </div>
          <div class="table-card">
            <div class="table-header"><span class="table-title">âœ¦ Poslednji pozivi (Ana AI)</span></div>
            ${dashData.recentEvents.slice(0, 4).map(c => `
              <div class="list-item">
                <div class="call-info">
                  <div class="call-icon">ğŸ“</div>
                  <div>
                    <div class="list-name">${c.caller}</div>
                    <div class="list-sub">${c.time}</div>
                  </div>
                </div>
                <span class="badge ${(c.details || '').toLowerCase().includes('rezervacija') ? 'badge-reservation' : 'badge-info'}">
                  ${c.details ? c.details.substring(0, 25) : c.type}
                </span>
              </div>`).join('')}
          </div>
        </div>`;
      break;

    case 'reservations':
      el.innerHTML = `
        <div class="table-card">
          <div class="table-header"><span class="table-title">âœ¦ Sve rezervacije</span></div>
          <div class="table-wrap">
            <table>
              <thead><tr><th>ID</th><th>Gost</th><th>Soba</th><th>Check-in</th><th>Check-out</th><th>Cena</th><th>Izvor</th><th>Status</th></tr></thead>
              <tbody>
                ${dashData.recentReservations.map(r => `
                  <tr>
                    <td class="td-id">${r.id}</td>
                    <td class="td-guest">${r.guest}</td>
                    <td>${r.room}</td>
                    <td>${r.checkIn}</td>
                    <td>${r.checkOut}</td>
                    <td class="td-price">${r.price}</td>
                    <td>${sourceBadge(r.source)}</td>
                    <td>${statusBadge(r.status)}</td>
                  </tr>`).join('')}
              </tbody>
            </table>
          </div>
        </div>`;
      break;

    case 'reviews':
      el.innerHTML = `
        <div class="stats-grid">
          ${statCard('ğŸ“¨', 'Ankete poslate', s.reviewsSent, '', true)}
          ${statCard('ğŸ˜Š', 'Pozitivne (4-5)', s.positiveReviews, 'â†’ Google Review')}
          ${statCard('ğŸ˜', 'Negativne (1-3)', s.negativeReviews, 'â†’ Interni feedback')}
          ${statCard('ğŸ“ˆ', 'Pozitivna stopa', reviewRate + '%', '', true)}
        </div>
        <div class="table-card">
          <div class="table-header"><span class="table-title">âœ¦ Sve ocene gostiju</span></div>
          ${dashData.recentReviews.map(r => `
            <div class="list-item" style="${r.rating < 4 ? 'background:rgba(231,76,60,0.03);' : ''}">
              <div>
                <div style="display:flex;align-items:center;gap:12px;">
                  <span class="list-name">${r.guest}</span>
                  ${starsHtml(r.rating)}
                </div>
                <div class="list-sub">${r.date}</div>
              </div>
              <span class="badge ${r.rating >= 4 ? 'badge-positive' : 'badge-negative'}">
                ${r.rating >= 4 ? 'Google Review â†—' : 'âš  Potrebna akcija'}
              </span>
            </div>`).join('')}
        </div>`;
      break;

    case 'calls':
      el.innerHTML = `
        <div class="stats-grid">
          ${statCard('ğŸ“', 'Ukupno poziva', s.totalCalls, '', true)}
          ${statCard('ğŸ’¬', 'Chat sesije', s.chatSessions)}
          ${statCard('ğŸ“§', 'Emailovi', s.emailsSent)}
          ${statCard('ğŸ¤–', 'AI Agent', 'Ana', '24/7 aktivna', true)}
        </div>

        <!-- Calls -->
        <div class="table-card">
          <div class="table-header"><span class="table-title">âœ¦ Pozivi</span></div>
          ${dashData.recentEvents.map(c => `
            <div class="list-item">
              <div class="call-info">
                <div class="call-icon">ğŸ“</div>
                <div>
                  <div class="list-name">${c.caller}</div>
                  <div class="list-sub">${c.time} Â· ${c.type}</div>
                </div>
              </div>
              <span class="badge badge-info">${c.details ? c.details.substring(0, 30) : 'N/A'}</span>
            </div>`).join('')}
        </div>

        <!-- Chat Sessions -->
        <div class="table-card">
          <div class="table-header"><span class="table-title">âœ¦ Chat sesije</span></div>
          ${dashData.recentChats.length > 0 ? dashData.recentChats.map(c => `
            <div class="chat-item">
              <div class="chat-meta">${c.date} Â· Sesija: ${c.sessionId} Â· ${c.language === 'sr' ? 'ğŸ‡·ğŸ‡¸' : 'ğŸ‡¬ğŸ‡§'}</div>
              <div style="margin-top:8px;">
                <div class="chat-guest">${c.message}</div>
              </div>
              <div style="margin-top:6px;text-align:right;">
                <div class="chat-ana">${c.reply ? c.reply.substring(0, 120) + '...' : 'N/A'}</div>
              </div>
            </div>`).join('') : '<div style="padding:30px;text-align:center;color:#444;">Nema chat sesija</div>'}
        </div>`;
      break;

    case 'feedback':
      el.innerHTML = `
        <div class="stats-grid">
          ${statCard('ğŸ“', 'Ukupno feedbacka', dashData.recentFeedback.length, '', true)}
          ${statCard('âš ï¸', 'ÄŒeka odgovor', dashData.recentFeedback.filter(f => f.status.includes('Novo')).length, '', false)}
        </div>
        <div class="table-card">
          <div class="table-header"><span class="table-title">âœ¦ Feedback od nezadovoljnih gostiju</span></div>
          ${dashData.recentFeedback.length > 0 ? dashData.recentFeedback.map(f => `
            <div class="feedback-item">
              <div style="display:flex;justify-content:space-between;align-items:center;">
                <div>
                  <span class="list-name">${f.guest}</span>
                  <span style="color:#555;font-size:11px;margin-left:8px;">(${f.email})</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;">
                  ${starsHtml(parseInt(f.rating) || 0)}
                  <span class="feedback-status">${f.status}</span>
                </div>
              </div>
              <div class="feedback-comment">"${f.comment}"</div>
              <div class="list-sub">${f.date} Â· Rezervacija: ${f.reservationId || 'N/A'}</div>
            </div>`).join('') : '<div style="padding:40px;text-align:center;color:#444;font-size:14px;">ğŸ‰ Nema negativnog feedbacka â€” svi gosti su zadovoljni!</div>'}
        </div>`;
      break;
  }
}

// Init
fetchData();
// Auto refresh every 60 seconds
setInterval(fetchData, 60000);
</script>
</body>
</html>
